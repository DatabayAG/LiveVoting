var xlvoFreeInputCategorize={drake:null,base_url:"",init:function(a){this.base_url=a,this.initDragula(),this.initButtons(),this.initialized=!0,console.log("xlvoFreeInputCategorize initialized")},initDragula:function(){this.drake=dragula([$("div.bars")[1]],{moves:function(a){return $(a).is("div")},accepts:function(a,b,c){return b!==c}}).on("drag",function(){xlvoFreeInputCategorize.recalculatePlayerHeight()}).on("drop",function(a,b){console.log(a),xlvoFreeInputCategorize.changeCategory($(a).find("div.xlvo-vote-free-input")[0].getAttribute("data-vote-id"),$(b).attr("data-category-id")),xlvoFreeInputCategorize.recalculatePlayerHeight()}),$("div#categories fieldset").each(function(a,b){xlvoFreeInputCategorize.drake.containers.push(b)})},initButtons:function(){$("input.category_input:last").on("keypress",function(a){13==a.which&&xlvoFreeInputCategorize.addCategory()}),$("button.category_button:last").on("click",xlvoFreeInputCategorize.addCategory),$("input.answer_input:last").on("keypress",function(a){13==a.which&&xlvoFreeInputCategorize.addAnswer()}),$("button.answer_button:last").on("click",xlvoFreeInputCategorize.addAnswer)},addCategory:function(){$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"add_category",title:$("#category_input").val()}).done(function(a){$("div#categories").append("<div id=\"category_id_"+a.category_id+"\" class=\"col-md-4\" data-category-id=\""+a.category_id+"\"><button type=\"button\" class=\"close\" aria-label=\"Close\" onClick=\"xlvoFreeInputCategorize.removeCategory($(this).parent());\"><span aria-hidden=\"true\">&times;</span></button><fieldset class=\"well xlvo-category category_dropzone\" data-category-id=\""+a.category_id+"\"><legend>"+$("#category_input").val()+"</legend></fieldset></div>"),console.log($("div#categories fieldset").last()[0]),xlvoFreeInputCategorize.drake.containers.push($("div#categories fieldset").last()[0]),$("#category_input").val(""),xlvoFreeInputCategorize.recalculatePlayerHeight()})},removeCategory:function(a){category_id=$(a).attr("data-category-id"),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"remove_category",category_id:category_id}).done(function(){$(a).find("div.col-md-4").each(function(a,b){console.log(b),$("div#bars").append(b)}),a.remove(),xlvoFreeInputCategorize.recalculatePlayerHeight()})},addAnswer:function(){$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"add_vote",input:$("#answer_input").val()}).done(function(a){$("div#bars").append("<div class=\"col-md-4\"><div id=\"vote_id_"+a.vote_id+"\" class=\"xlvo-vote-free-input\" data-vote-id=\""+a.vote_id+"\"><button type=\"button\" class=\"close\" aria-label=\"Close\" onClick=\"xlvoFreeInputCategorize.removeAnswer($(this).parent().parent())\"><span aria-hidden=\"true\">&times;</span></button><div class=\"well well-sm\"><span>"+$("#answer_input").val()+"</span></div></div></div>"),$("#answer_input").val(""),xlvoFreeInputCategorize.recalculatePlayerHeight()})},removeAnswer:function(a){vote_id=$(a).find("div.xlvo-vote-free-input")[0].getAttribute("data-vote-id"),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"remove_vote",vote_id:vote_id}).done(function(){$(a).remove(),xlvoFreeInputCategorize.recalculatePlayerHeight()})},changeCategory:function(a,b){console.log(a),console.log(b),$.post(xlvoPlayer.config.base_url+"&cmd=apiCall",{call:"change_category",vote_id:a,category_id:"undefined"===b?0:b}).done(function(){})},recalculatePlayerHeight:function(){var a=$("#xlvo-display-player").children();$("#xlvo-display-player").css("height",a.css("height"))}};
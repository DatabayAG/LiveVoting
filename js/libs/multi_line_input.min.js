(function(a){a.fn.extend({multi_line_input:function(g,j){var c=a.extend({unique_values:false},j);var g=g;var d=this;var b=0;var i=a(this).find(".multi_input_line").first();var e="empty";var f=function(k){k.hide();k.removeClass("multi_input_line");k.find("textarea[name^='"+d.attr("id")+"'], input[name^='"+d.attr("id")+"'], select[name^='"+d.attr("id")+"']").each(function(){var l=a(this).attr("name");var o=d.attr("id");var m=new RegExp("^"+o+"[[0-9]+](.*)$","g");var n=m.exec(l);l=e+"["+b+"]"+n[1];a(this).attr("name",l)})};f(i);var h=function(k,m){var m=m||false;var l=k;a(k).find(".add_button").on("click",function(o){var n=i.clone();n.show();a(n).addClass("multi_input_line");h(n);a(d).append(n);a(d).change();a(document).trigger("multi_line_add_button",[l,n]);return false});a(k).find(".up_button").on("click",function(n){a(this).parents(".multi_input_line").insertBefore(a(this).parents(".multi_input_line").prev());return false});a(k).find(".down_button").on("click",function(n){a(this).parents(".multi_input_line").insertAfter(a(this).parents(".multi_input_line").next());return false});a(k).find(".remove_button").on("click",function(n){l.remove();a(d).change();a(document).trigger("multi_line_remove_button",l);return false});if(!m){l.find("textarea[name^='"+e+"'], input[name^='"+e+"'], select[name^='"+e+"']").each(function(){var n=a(this).attr("name");var q=d.attr("id");a(this).val("");var o=new RegExp("^"+e+"[[0-9]+](.*)$","g");var p=o.exec(n);n=q+"["+b+"]"+p[1];a(this).attr("name",n);a('input[name="'+n+'"]').focus()})}b++};a(this).find(".multi_input_line").each(function(){h(a(this),true)});a(d).change();return d}})}(jQuery));
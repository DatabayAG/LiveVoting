(function(a){a.fn.extend({multi_line_input:function(g,k){var c=a.extend({unique_values:false},k);var g=g;var d=this;var j=this;var b=0;var i=a(this).find(".multi_input_line").first();var e="empty";var f=function(l){l.hide();l.removeClass("multi_input_line");l.find("textarea[name^='"+d.attr("id")+"'], input[name^='"+d.attr("id")+"'], select[name^='"+d.attr("id")+"']").each(function(){var m=a(this).attr("name");var p=d.attr("id");var n=new RegExp("^"+p+"[[0-9]+](.*)$","g");var o=n.exec(m);m=e+"["+b+"]"+o[1];a(this).attr("name",m)})};f(i);var h=function(l,n){var n=n||false;var m=l;a(l).find(".add_button").on("click",function(p){var o=i.clone();o.show();a(o).addClass("multi_input_line");h(o);a(d).append(o);a(d).change();a(document).trigger("multi_line_add_button",[m,o]);a(d).find("textarea, input[type='text']").last().focus();return false});a(l).find(".up_button").on("click",function(o){a(this).parents(".multi_input_line").insertBefore(a(this).parents(".multi_input_line").prev());return false});a(l).find(".down_button").on("click",function(o){a(this).parents(".multi_input_line").insertAfter(a(this).parents(".multi_input_line").next());return false});a(l).find(".remove_button").on("click",function(o){m.remove();a(d).change();a(document).trigger("multi_line_remove_button",m);return false});if(!n){m.find("textarea[name^='"+e+"'], input[name^='"+e+"'], select[name^='"+e+"']").each(function(){var o=a(this).attr("name");var r=d.attr("id");a(this).val("");var p=new RegExp("^"+e+"[[0-9]+](.*)$","g");var q=p.exec(o);o=r+"["+b+"]"+q[1];a(this).attr("name",o)})}b++};a(this).find(".multi_input_line").each(function(){h(a(this),true)});a(d).change();return d}})}(jQuery));